FROM golang:1.24.3-alpine

# Install testing dependencies
RUN apk add --no-cache \
    ca-certificates \
    tzdata \
    netcat-openbsd \
    curl \
    bind-tools \
    git

# Set working directory to the app root where go.mod is located
WORKDIR /app

# Default command is to run tests in the tests directory
CMD ["sh", "-c", "cd /app && go test -v ./tests/integration_test.go ./tests/integration_bootstrap_test.go -tags=integration"]
